# REST\~Webのアーキテクチャスタイル~

## アーキテクチャスタイルの重要性

- RESTはWebのアーキテクチャスタイル
- アーキテクチャ
  - 別名「(マクロ)アーキテクチャパターン」
  - 複数のアーキテクチャに共通する性質、様式、作法あるいは、流儀を指す言葉
  - e.g.) MVC(Model-View-Controller)・パイプ＆フィルタ、イベントシステム



## アーキテクチャスタイルとしてのREST

- REST
  - ネットワークシステムのアーキテクチャスタイル
    - 最も有名→クライアント/サーバ→Webはクライアント/サーバ
- WebのアーキテクチャスタイルはRESTでもあり、クライアント/サーバでもある
- RESTはクライアント/サーバから派生したアーキテクチャスタイルである
  - 素のクライアント/サーバアーキテクチャスタイルにいくつかの制約を加えていくと、RESTというアーキテクチャスタイルになる

 

## リソース

- RESTにおける重要な概念の一つにリソースがある
- Webにおけるリソースの例
  - 東京の天気予報
  - 技術評論社の「Webを支える技術」のページ
  - 新花巻駅の写真
  - 最近のブックマーク
- リソース→「Web上に存在する、名前をもったありとあらゆる情報」

### リソースの名前としてのURI

- リソースの名前とはURIのことである
  - 東京の天気予報
    http:weather.yahoo.co.jp/weather/jp/13/4410.html
- リソースとはWeb上の情報である
- 世界中の無数のリソースは、それぞれURIで一意の名前を持つ
- URIを用いることで、プログラムはリソースが表現する情報にアクセスできる

### リソースの表現と状態

- リソースは「Web上に存在する情報」という抽象的な概念
- サーバとクライアントの間で実際にリソースをやりとりするときには、何らかの具体的なデータを送信し合う
  - サーバとクライアントの間でやりとりするデータのことを「リソースの表現」と呼ぶ

## スタイルを組み合わせてRESTを構成する

### クライアント/サーバ

- Webは、HTTPというプロトコルでクライアントとサーバが通信するクライアント/サーバのアーキテクチャスタイルを採用している
  - クライアントはサーバにリクエストを送り、サーバはそれに対してレスポンスを返す
- クライアント/サーバの利点
  - 単一のコンピュータ上ですべてを処理するのではなく、クライアントとサーバに分離して処理できること
  - これによりクライアントをマルチプラットフォームにできる
  - ユーザインターフェースはクライアントが担当する
    - サーバはデータストレージとしての機能だけを提供すればよくなる
  - 複数のサーバを組み合わせて冗長化することで、可用性を上げられる

### ステートレスサーバ

- クライアント/サーバに最初に追加するアーキテクチャスタイル
  - ステートレスサーバ
- ステートレス
  - クライアントのアプリケーション状態をサーバで管理しないことを意味する
  - サーバがアプリケーション状態を持たないことの利点は、サーバ側の実装を簡略化できることである。
  - 簡略な実装のサーバは、クライアントからのリクエストに応えたあとすぐにサーバの計算機リソースを解放できる
- 現実にはステートレスでないWebサービスやWeb APIが多々ある
  - HTTPをステートフルにする代表格はCookieを使ったセッション管理である
  - RESTの視点から見ると、Cookieを使ったセッション管理は間違ったHTTPの拡張である
  - ただ、REST的に間違えているからといって、Cookieを使ったフォーム認証をやめるわけにはいかないことも事実である
- クライアント/サーバにステートレス性を導入すると、アーキテクチャスタイルは「クライアント/ステートレスサーバ」になる

### キャッシュ

- キャッシュ
  - リソースの鮮度に基づいて、一度取得したリソースをクライアント側で使い回す方式である。
- キャッシュの利点
  - サーバとクライアントの間の通信を減らすことでネットワーク帯域の利用や処理時間を縮小し、より効率的に処理できることである→古いキャッシュを利用してしまい、情報の信頼性が下がる可能性もある

### 統一インターフェース

- 統一インターフェース
  - URIで指し示したりリソースに対する操作を、統一した限定的なインターフェースで行うアーキテクチャスタイルのことである
- HTTP1.1
  - GETやPOSTなど8個のメソッドだけが定義されており、通常はこれ以上メソッドが増えない

### 階層化システム

- 統一インターフェースの利点

  - システム全体が階層化しやすい

  - Webサービス

    - サーバとクライアントの間にロードバランサを設置して負荷分散

    - プロキシを設置してアクセスを制限したりする

      → クライアントからするとサーバもプロキシも同じインターフェースで接続できるので、接続先がサーバからプロキシに変わったことを意識する必要はない。

      → これは、サーバやプロキシなどの各コンポーネント間のインターフェースをHTTPで統一しているため、実現できている

### コードオンデマンド

- コードオンデマンド
  - プログラムコードをサーバからダウンロードし、クライアント側でそれを実行するアーキテクチャスタイルである。e.g.) JavaScriptやFlash、Javaアプレットなど
- コードオンデマンドの利点
  - クライアントをあとから拡張できること
- コードオンデマンドの欠点
  - ネットワーク通信におけるプロトコルの可視性が低下すること
  - HTTPというアプリケーションプロトコルに従って通信している間は、通信の意味やアクセスするリソースが明白である。
  - コードオンデマンドでプログラムをダウンロードし、クライアント側で実行してしまうと、アプリケーションプロトコルの可視性は低下する

### REST=ULCODC＄SS

- RESTとは、次の６つを組み合わせたアーキテクチャスタイルのことである
  - クライアント/サーバ：ユーザインターフェースと処理を分離する
  - ステートレスサーバ：サーバ側でアプリケーション状態を持たない
  - キャッシュ：クライアントとサーバの通信回数と量を減らす
  - 統一インターフェース：インターフェースを固定する
  - 階層化システム：システムを階層に分離する

## RESTの２つの側面

### RESTとハイパーメディア

